# Красильникова Вероника К0609-23
## Case-3 

---

#### 3. Балансировка / распределение нагрузки
* использование Ngin8 в качестве балансировщика (proxy)

Nginx - это обратный прокси-сервер, который распределяет входящие запросы между несколькими серверами для повышения производительности и отказоустойчивости

* маршрутизация с использованием location (эндпоинты)

в nginx маршрутизация настраивается с помощью эндпоинтов, которые определяет, как запрос будет обрабатываться к путям. он в директиве location смотрит на путь, например /api и отправляет на сервер /backend_api и тд

* условная маршрутизация IF

nginx позволяет использовать условия для маршрутизации. например, если запрос пришел с мобильного устройства, то его нужно отправить на мобильный сервер

```nginx
    if ($http_user_agent ~* "Android|iPhone") {
        proxy_pass http://mobile_backend;  # Мобильные → на mobile_backend
    }
```

* таблицы сопоставления MAP

директива map позволяет создавать гибкие условия маршрутизации на основе каких-либо переменных, например, IP-адреса. это некая таблица правил для сложной машрутизации. используется для маршрутизации по типу устройства, для разных версий сайта в разных странах и тд

* группировка сервисов UPSTRAM

nginx использует группировку сервисов upstram для балансировки нагрузки. вместо одного сервиса можно задать несколько, и балансировщик будет распределять запросы между ними
например: 
```nginx
upstream backend {
    server backend1.example.com weight=3;  #получает в 3 раза больше запросов
    server backend2.example.com;
    server backup.example.com backup;  #используется только при недоступности основных
}
```

* коды ответов HTTP сервера (ошибки, перенаправление и др.)

HTTP-коды:
2хх - успех (200 OK)
3хх - перенаправление (302 Found)
4хх - ошибка клиента (404 Not Found)
5хх - пошибка сервера (501 Bad Gateway)
в nginx можно сделать ручное возвращение статусов, перенаправление или кастомную страницу ошибки
```nginx
#принудительное перенаправление
location /old {
    return 301 /new;
}

#кастомные страницы ошибок
error_page 404 /404.html;
error_page 500 502 503 504 /50x.html;
```
>>>>>>> c7731a7 (1)
